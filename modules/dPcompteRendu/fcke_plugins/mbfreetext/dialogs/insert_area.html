<!DOCTYPE html 
     PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
     "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <style type="text/css">
      body, table {
          font: inherit;
      }
    </style>
    <script>
      var CKEDITOR = window.parent.CKEDITOR;

      function Ok(e) {
        var editor = CKEDITOR.instances.htmlarea;
        var txtData = document.getElementById('txtData');
        var content = txtData.value;
        txtData.value = '';
        if (content != '') {
          var sHtml = "<span class='field' contenteditable='false'>[[Texte libre - " + content + "]]</span>;";
          var elt = CKEDITOR.dom.element.createFromHtml(sHtml, editor.document);
          editor.insertElement(elt);
          editor.insertText(" ");
          editor.fire("key", []);
        }
        return true;
      }

      CKEDITOR.dialog.getCurrent().on("ok", Ok);
    </script>
  </head>
  <body style="overflow: hidden">
    <table cellspacing="0" cellpadding="0" width="100%" border="0">
      <tr>
        <td style="white-space: nowrap">
          Veuillez donner un nom à la zone de texte libre : <br />
          <input id="txtData" type="text" />
        </td>
      </tr>
    </table>
  </body>
</html>
